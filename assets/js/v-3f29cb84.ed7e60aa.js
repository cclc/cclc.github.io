"use strict";(self.webpackChunkcclc_vuepress=self.webpackChunkcclc_vuepress||[]).push([[6157],{3422:(n,s,a)=>{a.r(s),a.d(s,{data:()=>t});const t={key:"v-3f29cb84",path:"/mess-knowledge/php-excel.html",title:"【PHP】以php为例直接用Html生成Excel文件",lang:"zh-CN",frontmatter:{title:"【PHP】以php为例直接用Html生成Excel文件",date:"2016-09-27",categories:["PHP"],tags:["PHP"]},excerpt:"",headers:[],git:{},filePathRelative:"mess-knowledge/php-excel.md"}},9245:(n,s,a)=>{a.r(s),a.d(s,{default:()=>l});var t=a(6252);const e=(0,t.uE)('<h1 id="【php】以-php-为例直接用-html-生成-excel-文件" tabindex="-1"><a class="header-anchor" href="#【php】以-php-为例直接用-html-生成-excel-文件" aria-hidden="true">#</a> 【PHP】以 php 为例直接用 Html 生成 Excel 文件</h1><p>以前都用 PHPExcel 等工具来生成 Excel，功能很强大，但是有时我们只是要一个简单的数据输出而已，再使用那些就有些繁琐了。碰巧发现了一个十分简便的方法，就此记录下来。</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>这里主要是使用了 Content-Type 来实现我们想要的功能，然后使用 PHP 等编程语言来取得我们想要的数据。</p></div><p>在 html 的 header 中加入以下两句就能使你的网页内容以.xls 附件形式直接下载下来</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Content-type: application/vnd.ms-excel; charset=utf8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Content-Disposition: attachment; filename=filename.xls&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>这是一个完整的 PHP 文件：</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>\n\n<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Content-type: application/vnd.ms-excel; charset=utf8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Content-Disposition: attachment; filename=filename.xls&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token variable">$data</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">&quot;&lt;table&gt;&quot;</span><span class="token punctuation">;</span>\n<span class="token variable">$data</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">&quot;&lt;tr&gt;&quot;</span><span class="token punctuation">;</span>\n<span class="token variable">$data</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">&quot;&lt;td&gt;……&lt;/td&gt;&quot;</span><span class="token punctuation">;</span>\n<span class="token variable">$data</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">&quot;&lt;td&gt;……&lt;/td&gt;&quot;</span><span class="token punctuation">;</span>\n<span class="token variable">$data</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">&quot;&lt;td&gt;……&lt;/td&gt;&quot;</span><span class="token punctuation">;</span>\n<span class="token variable">$data</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">&quot;&lt;td&gt;……&lt;/td&gt;&quot;</span><span class="token punctuation">;</span>\n<span class="token variable">$data</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">&quot;&lt;td&gt;……&lt;/td&gt;&quot;</span><span class="token punctuation">;</span>\n<span class="token variable">$data</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">&quot;&lt;/tr&gt;&quot;</span><span class="token punctuation">;</span>\n<span class="token variable">$data</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">&quot;&lt;/table&gt;&quot;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">echo</span> <span class="token variable">$data</span><span class="token operator">.</span> <span class="token string double-quoted-string">&quot;\\t&quot;</span><span class="token punctuation">;</span>\n\n<span class="token delimiter important">?&gt;</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当然了，你也可以从数据库中读取或者循环生成一些数据来填充 excel 也是可以的。</p>',8),p={href:"http://tool.oschina.net/commons",target:"_blank",rel:"noopener noreferrer"},o={},l=(0,a(3744).Z)(o,[["render",function(n,s){const a=(0,t.up)("ExternalLinkIcon");return(0,t.wg)(),(0,t.iD)(t.HY,null,[e,(0,t._)("p",null,[(0,t._)("a",p,[(0,t.Uk)("http://tool.oschina.net/commons"),(0,t.Wm)(a)]),(0,t.Uk)(" 这里有详细的 HTTP Content-type 常用对照表，用好这里的信息就能生成各种想要的文件啦")])],64)}]])},3744:(n,s)=>{s.Z=(n,s)=>{const a=n.__vccOpts||n;for(const[n,t]of s)a[n]=t;return a}}}]);