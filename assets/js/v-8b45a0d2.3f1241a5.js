"use strict";(self.webpackChunkcclc_vuepress=self.webpackChunkcclc_vuepress||[]).push([[4546],{9809:(n,s,a)=>{a.r(s),a.d(s,{data:()=>t});const t={key:"v-8b45a0d2",path:"/frontend/canvas-zoom-img-by-mouse.html",title:"使用鼠标滚轮做图片缩放",lang:"zh-CN",frontmatter:{title:"使用鼠标滚轮做图片缩放",date:"2021-10-28",categories:["H5"],tags:["H5","Canvas"]},excerpt:"",headers:[{level:2,title:"1.对指定 dom 加入事件监听",slug:"_1-对指定-dom-加入事件监听",children:[]},{level:2,title:"2.事件处理函数",slug:"_2-事件处理函数",children:[]},{level:2,title:"3.记得在此页面销毁前去除事件监听",slug:"_3-记得在此页面销毁前去除事件监听",children:[]}],git:{},filePathRelative:"frontend/canvas-zoom-img-by-mouse.md"}},5174:(n,s,a)=>{a.r(s),a.d(s,{default:()=>u});var t=a(6252);const p=(0,t._)("h1",{id:"使用鼠标滚轮做图片缩放",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#使用鼠标滚轮做图片缩放","aria-hidden":"true"},"#"),(0,t.Uk)(" 使用鼠标滚轮做图片缩放")],-1),e=(0,t._)("p",null,"使用 Canvas 显示图片，将鼠标悬浮在“图片”（CanvasContainer）内，滚动鼠标滚轮来进行图片缩放。",-1),o={class:"table-of-contents"},c=(0,t.uE)('<p>基于以下教程开发</p><ul><li><a href="../frontend/canvas-show-img">1.图片在 Canvas 里显示的教程</a></li><li><a href="../frontend/Canvas-zoom-img-by-button">2.使用按钮做图片缩放</a></li></ul><h2 id="_1-对指定-dom-加入事件监听" tabindex="-1"><a class="header-anchor" href="#_1-对指定-dom-加入事件监听" aria-hidden="true">#</a> 1.对指定 dom 加入事件监听</h2><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>canvasContainer<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span><span class="token property">text-align</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span><span class="token property">overflow</span><span class="token punctuation">:</span>auto</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>canvas<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tabindex</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n    Sorry, your browser does not support HTML5 Canvas functionality which is\n    required for this application.\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> canvasContainer <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;canvasContainer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// for firefox</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>canvasContainer<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  canvasContainer<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>\n    <span class="token string">&quot;DOMMouseScroll&quot;</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">scrollFunc</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">&quot;dom&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token boolean">false</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token comment">// for non firefox</span>\ncanvasContainer<span class="token punctuation">.</span><span class="token function-variable function">onmousewheel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">scrollFunc</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">&quot;dom&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-事件处理函数" tabindex="-1"><a class="header-anchor" href="#_2-事件处理函数" aria-hidden="true">#</a> 2.事件处理函数</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">scrollFunc</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">let</span> delta <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> event <span class="token operator">=</span> e <span class="token operator">||</span> window<span class="token punctuation">.</span>event<span class="token punctuation">;</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>altKey <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span>ctrlKey <span class="token operator">&amp;&amp;</span> dom<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>event<span class="token punctuation">.</span>altKey <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>event<span class="token punctuation">.</span>ctrlKey <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>dom<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>wheelDelta<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">//IE、chrome浏览器使用的是wheelDelta，并且值为“正负120”</span>\n    delta <span class="token operator">=</span> event<span class="token punctuation">.</span>wheelDelta <span class="token operator">/</span> <span class="token number">120</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>opera<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      delta <span class="token operator">=</span> <span class="token operator">-</span>delta<span class="token punctuation">;</span> <span class="token comment">//因为IE、chrome等向下滚动是负值，FF是正值，为了处理一致性，在此取反处理</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>detail<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    delta <span class="token operator">=</span> <span class="token operator">-</span>event<span class="token punctuation">.</span>detail <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>delta<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">handleScroll</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">handleScroll</span><span class="token punctuation">(</span><span class="token parameter">delta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>delta <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 向下滚动</span>\n    <span class="token function">zoomIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在上一章有这个函数的实现方式</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 向上滚动</span>\n    <span class="token function">zoomOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在上一章有这个函数的实现方式</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-记得在此页面销毁前去除事件监听" tabindex="-1"><a class="header-anchor" href="#_3-记得在此页面销毁前去除事件监听" aria-hidden="true">#</a> 3.记得在此页面销毁前去除事件监听</h2><p>不去掉监听会影响其他页面的显示和操作效果</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;DOMMouseScroll&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span> <span class="token comment">//W3C</span>\nwindow<span class="token punctuation">.</span>onmousewheel <span class="token operator">=</span> document<span class="token punctuation">.</span>onmousewheel <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> canvasContainer <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementBy</span><span class="token punctuation">(</span><span class="token string">&quot;canvasContainer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>canvasContainer <span class="token operator">&amp;&amp;</span> canvasContainer<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span><span class="token punctuation">{</span>\n  canvasContainer<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;DOMMouseScroll&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  canvasContainer<span class="token punctuation">.</span>onmousewheel <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可通过按钮、框选、滚轮滚动来放大缩小图片的示例：</p>',11),l={},u=(0,a(3744).Z)(l,[["render",function(n,s){const a=(0,t.up)("RouterLink"),l=(0,t.up)("canvas-zoom-img");return(0,t.wg)(),(0,t.iD)(t.HY,null,[p,e,(0,t._)("nav",o,[(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Wm)(a,{to:"#_1-对指定-dom-加入事件监听"},{default:(0,t.w5)((()=>[(0,t.Uk)("1.对指定 dom 加入事件监听")])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#_2-事件处理函数"},{default:(0,t.w5)((()=>[(0,t.Uk)("2.事件处理函数")])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#_3-记得在此页面销毁前去除事件监听"},{default:(0,t.w5)((()=>[(0,t.Uk)("3.记得在此页面销毁前去除事件监听")])),_:1})])])]),c,(0,t.Wm)(l)],64)}]])},3744:(n,s)=>{s.Z=(n,s)=>{const a=n.__vccOpts||n;for(const[n,t]of s)a[n]=t;return a}}}]);