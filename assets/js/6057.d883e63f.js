"use strict";(self.webpackChunkcclc_vuepress=self.webpackChunkcclc_vuepress||[]).push([[6057],{6057:(e,t,s)=>{s.r(t),s.d(t,{default:()=>m});var a=s(6252);const n=e=>((0,a.dD)("data-v-fce0c1d0"),e=e(),(0,a.Cn)(),e),i={id:"handleImage",style:{border:"solid 1px black"}},o=n((()=>(0,a._)("div",{id:"fileNameTable"},null,-1))),h=n((()=>(0,a._)("div",{id:"fileMenu"},null,-1))),c=n((()=>(0,a._)("div",{id:"actionBar"},null,-1))),r={style:{float:"right"}},l=n((()=>(0,a._)("div",{id:"canvasContainer",style:{width:"100%","margin-top":"10px","text-align":"center",overflow:"auto"}},[(0,a._)("canvas",{id:"canvas",width:"1",height:"1",tabindex:"1"}," Sorry, your browser does not support HTML5 Canvas functionality which is required for this application. ")],-1))),d={data:()=>({imageData:"/blog_images/canvas-zoom-img-by-button/1.jpg",originImageData:"/blog_images/canvas-zoom-img-by-button/1.jpg",currentPage:1,pageSize:100,classList:[],classOption:[],iframeLoadStatus:!1,imageShow:!1,zoomRate:1,canvas:{},context:{},offscreenCanvas:{},offscreenContext:{},mousedown:{},rubberbandRectangle:{},dragging:!1,scaleRate:1,mousemove:{}}),created(){},mounted(){this.canvas=document.getElementById("canvas"),this.context=this.canvas.getContext("2d"),this.offscreenCanvas=document.createElement("canvas"),this.offscreenContext=this.offscreenCanvas.getContext("2d"),this.canvas.onmousedown=e=>{let t=this.windowToCanvas(this.canvas,e.clientX,e.clientY);e.preventDefault(),this.mousedown.x=t.x,this.mousedown.y=t.y,this.rubberbandRectangle.left=this.mousedown.x,this.rubberbandRectangle.top=this.mousedown.y,this.dragging=!0},this.canvas.onmousemove=e=>{let t={};this.dragging?(this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.drawImage(this.offscreenCanvas,0,0,this.canvas.width,this.canvas.height),t=this.windowToCanvas(this.canvas,e.clientX,e.clientY),this.rubberbandStretch(t.x,t.y)):this.mousemove=this.windowToCanvas(this.canvas,e.clientX,e.clientY)},this.canvas.onmouseup=e=>{let t=this.windowToCanvas(this.canvas,e.clientY,e.clientY);this.rubberbandEnd(t.x,t.y)};const e=document.getElementById("canvasContainer");e.addEventListener&&e.addEventListener("DOMMouseScroll",(e=>{this.scrollFunc(e,"dom")}),!1),e.onmousewheel=e=>{this.scrollFunc(e,"dom")},this.windowResize(),this.drawImage(),window.onresize=()=>{this.windowResize(),this.drawImage()}},destroyed(){this.removeKeyDownMonitor(),document.addEventListener&&document.addEventListener("DOMMouseScroll",{},!1),window.onmousewheel=document.onmousewheel={};const e=document.getElementById("canvasContainer");e&&e.addEventListener&&(e.addEventListener("DOMMouseScroll",{},!1),e.onmousewheel={})},methods:{drawImage(){this.windowResize();const e=document.getElementById("canvasContainer");if(e&&this.canvas&&this.context){const t=new Image;t.src=this.imageData,t.onload=()=>{const s=(e.offsetHeight-5)/t.height,a=(e.offsetWidth-5)/t.width;this.scaleRate=s>a?a:s,this.context.scale(this.scaleRate,this.scaleRate),this.canvas.width=Math.round(t.width*this.scaleRate*this.zoomRate),this.canvas.height=Math.round(t.height*this.scaleRate*this.zoomRate),this.context.beginPath(),this.context.drawImage(t,0,0,this.canvas.width,this.canvas.height),this.context.stroke(),this.offscreenCanvas.width=t.width,this.offscreenCanvas.height=t.height,this.offscreenContext.drawImage(t,0,0,this.offscreenCanvas.width,this.offscreenCanvas.height)}}},windowToCanvas(e,t,s){let a=e.getBoundingClientRect();return{x:t-a.left,y:s-a.top}},rubberbandStretch(e,t){this.rubberbandRectangle.left=Math.min(e,this.mousedown.x),this.rubberbandRectangle.top=Math.min(t,this.mousedown.y),this.rubberbandRectangle.width=Math.abs(e-this.mousedown.x),this.rubberbandRectangle.height=Math.abs(t-this.mousedown.y),this.context.fillStyle="rgba(96,98,102,0.3)",this.context.fillRect(this.rubberbandRectangle.left,this.rubberbandRectangle.top,this.rubberbandRectangle.width,this.rubberbandRectangle.height)},rubberbandEnd(e,t){if(e!=this.rubberbandRectangle.left&&t!=this.rubberbandRectangle.top){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvas.width=this.rubberbandRectangle.width/this.scaleRate/this.zoomRate,this.canvas.height=this.rubberbandRectangle.height/this.scaleRate/this.zoomRate,this.context.drawImage(this.offscreenCanvas,this.rubberbandRectangle.left/this.scaleRate/this.zoomRate,this.rubberbandRectangle.top/this.scaleRate/this.zoomRate,this.rubberbandRectangle.width/this.scaleRate/this.zoomRate,this.rubberbandRectangle.height/this.scaleRate/this.zoomRate,0,0,this.rubberbandRectangle.width/this.scaleRate/this.zoomRate,this.rubberbandRectangle.height/this.scaleRate/this.zoomRate);var s=this.canvas.toDataURL("image/jpg");this.imageData=s,this.drawImage(),this.dragging=!1}else this.dragging=!1},zoomIn(){this.zoomRate=1.1*this.zoomRate,this.drawImage(),document.getElementsByClassName("zoomButton")[1].blur()},zoomOut(){this.zoomRate=this.zoomRate/1.1,this.drawImage(),document.getElementsByClassName("zoomButton")[0].blur()},resetZoomLevel(){this.zoomRate=1,this.imageData=this.originImageData,this.drawImage(),document.getElementsByClassName("zoomButton")[2].blur()},windowResize(){const e=document.getElementById("handleImage"),t=(document.getElementById("fileMenu"),document.getElementById("actionBar")),s=document.getElementById("canvasContainer"),a=(document.getElementById("fileNameTable"),document.documentElement.clientHeight);e&&t&&s&&(s.style.height=a-60-40-20-t.offsetHeight+8+"px")},removeKeyDownMonitor(){this.className="",this.classShortcutKey="",document.onkeydown=()=>{}},addKeyDownMonitor(){document.getElementById("handleImage").focus();const e=this.totalFileIdList.length/this.pageSize;document.onkeydown=()=>{const t=document.getElementById("fileNameTable"),s=document.getElementById("fileMenu"),a=window.event,n=this.classList;if("+"===a.key)this.zoomIn();else if("-"===a.key)this.zoomOut();else if("="===a.key)this.resetZoomLevel();else if(38===a.keyCode){if(this.currentRowIndex<=0)return void this.$message({message:this.$t("message.hasReachedTheTop"),type:"warning"});this.setCurrent(this.showFileNameList[this.currentRowIndex-1]),t.scrollTop=t.scrollHeight*(this.currentRowIndex/this.showFileNameList.length)-s.offsetHeight/3}else if(40===a.keyCode||32===a.keyCode){if(this.currentRowIndex>=this.showFileNameList.length-1)return void this.$message({message:this.$t("message.hasReachedTheBottom"),type:"warning"});this.setCurrent(this.showFileNameList[this.currentRowIndex+1]),t.scrollTop=t.scrollHeight*(this.currentRowIndex/this.showFileNameList.length)-s.offsetHeight/3}else if(37===a.keyCode){if(this.currentPage<=1)return void this.$message({message:this.$t("message.hasReachedTheTop"),type:"warning"});this.handlePaginationCurrentChange(this.currentPage-1,"shortcutKey"),t.scrollTop=0}else if(39===a.keyCode){if(this.currentPage>=e)return void this.$message({message:this.$t("message.hasReachedTheBottom"),type:"warning"});this.handlePaginationCurrentChange(this.currentPage+1,"shortcutKey"),t.scrollTop=0}for(let e=0;e<n.length;e++)a.key===n[e].shortcut_key&&("toBeChecked"!==this.handleImageInfo.category||"toBeChecked"===this.handleImageInfo.category)&&(this.chooseClass(n[e].id),this.saveClass())}},scrollFunc(e,t){let s=0;const a=e||window.event;return!(a.altKey&&a.ctrlKey&&t)&&!!(a.altKey||a.ctrlKey||t)&&(a.wheelDelta?(s=a.wheelDelta/120,window.opera&&(s=-s)):a.detail&&(s=-a.detail/3),void(s&&this.handleScroll(s)))},handleScroll(e){e<0?this.zoomIn():this.zoomOut()}}},m=(0,s(3744).Z)(d,[["render",function(e,t,s,n,d,m){return(0,a.wg)(),(0,a.iD)("div",i,[o,h,c,(0,a._)("div",r,[(0,a._)("button",{class:"zoomButton",onClick:t[0]||(t[0]=e=>m.zoomOut()),icon:"fa fa-search-minus fa-lg",circle:""}," Zoom Out "),(0,a._)("button",{class:"zoomButton",onClick:t[1]||(t[1]=e=>m.zoomIn()),icon:"fa fa-search-plus fa-lg",circle:""}," Zoom In "),(0,a._)("button",{class:"zoomButton",onClick:t[2]||(t[2]=e=>m.resetZoomLevel()),icon:"fa fa-undo fa-lg",circle:""}," Reset ")]),l])}],["__scopeId","data-v-fce0c1d0"]])},3744:(e,t)=>{t.Z=(e,t)=>{const s=e.__vccOpts||e;for(const[e,a]of t)s[e]=a;return s}}}]);